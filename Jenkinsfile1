pipeline
{
	agent any 
	stages
		{
			stage('git clone')
			{
				steps
				{
					git 'https://github.com/DhanshreeBorase/maven-project.git'
				}
			}
			stage ('install my project')
			{
				steps 
				{
					withMaven(jdk: 'localJDK' , maven: 'localMaven')
					{
						sh 'mvn install'
					}
				}
			}
			stage ('complile my project')
			{
				steps 
				{
					withMaven(jdk: 'localJDK' , maven: 'localMaven')
					{
						sh 'mvn compile'
					}
				}
			}
			stage('deploy to tomcat')
			{
				steps
				{
					sshagent (['tomcat']) 
            				{
                				sh 'scp -o StrictHostKeyChecking=no */target/*.war ec2-user@172.31.24.177:/var/lib/tomcat/webapps'
            				}
				}
			}
		}
}
